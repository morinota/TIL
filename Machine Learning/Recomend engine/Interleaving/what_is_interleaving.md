## 参考
- [Gunosyデータ分析ブログ](https://data.gunosy.io/entry/2018/10/15/080000)
- [Re:ゼロから始めるML生活 インターリービングについて勉強する](https://www.nogawanogawa.com/entry/interleaving)
- [A/Bテストより10~100倍効率的なランキング評価手法　インターリービング（Interleaving）のまとめと実践](https://qiita.com/mpkato/items/99bd55cc17387844fd62)

# Interleavingとは？
## 概要
- インターリービングは高感度なランキング評価手法。
  - 実験的に、**10倍から100倍従来のA/Bテストよりも効率的**であることが知られている(https://qiita.com/mpkato/items/99bd55cc17387844fd62)
- 従来のA/Bテストでは...
  - 2つのランキングリストを評価する際は、ユーザを2つの群に分け、各々に別々のランキングリストを提示し性能を評価する
- 一方でインターリービングでは...
  - 2つのランキングリストを**混ぜる**ことで新たなランキングを作成し、**同一のユーザー群**にそのランキングを提示し性能を評価する。
  - 同一のユーザー群で評価することで、極端な振る舞いをする少数のヘビーユーザーの行動に結果が左右されなくなるメリットもある

![](https://cdn-ak.f.st-hatena.com/images/fotolife/z/zer4/20181011/20181011150941.jpg)

- **ランキングリストの混ぜ方によって**、それぞれ名前がついている。
  -  代表的なものでは「Balanced Interleaving」「Team Draft Interleaving」「Probabilistic Interleaving」「Optimized Interleaving」がある。
- なお、**2つ**のランキングリストを1つに混ぜる手法は**インターリービング**と呼ばれ、**3つ以上**のランキングリストを混ぜる手法は**マルチリービング**と呼ばれる。

## 具体例(ex. Team Draft Interleaving)

Team Draft Interleavingを例に説明する。
チームドラフトは名前の通り、プロ野球のドラフト会議と同じような仕組み。
各チームの監督は、欲しい選手に対して以下の選好ランキングを持つと仮定する。

| 指名順位 | 監督1 | 監督2 | 
|------|-----|-----| 
| 1    | 選手A | 選手C | 
| 2    | 選手B | 選手B | 
| 3    | 選手C | 選手D | 
| 4    | 選手D | 選手A | 


ドラフト一巡目では、各チームの監督は抽選(ランダム)によって選手を選ぶ優先度が決まる。
ここでは監督1 < 監督2とする。

| 一巡目      | 
|----------| 
| 監督2: 選手C | 
| 監督1: 選手A | 

二巡目でも同様に、抽選によって選手を選ぶ優先度を決める。
ここでは、監督1 > 監督2とする。
**選手Bを両監督が指名**するため、優先度が高い監督1が選手Bを獲得し、**監督2は次に欲しい選手である選手Dを獲得**する。

| 二巡目      | 
|----------| 
| 監督1: 選手B | 
| 監督2: 選手D | 

一巡目、二巡目の結果をまとめると以下のようなリストが得られる。

| 混合ランキング  | 
|----------| 
| 監督2: 選手C | 
| 監督1: 選手A | 
| 監督1: 選手B | 
| 監督2: 選手D | 

このように**各巡目でランダムに優先度をつけ**、複数の選好リストから**アイテムを選択していく**手法が**Team Draft Interleaving**。
実際の推薦システムでは、**各監督＝テスト対象のアルゴリズム**に相当し、**選手＝ニュース記事**、**各監督による選手の指名順位＝各アルゴリズムによる記事の推薦結果**に当たる。
**ドラフトのi巡目＝ユーザーのリクエスト**の度に、混合ランキングを生成する。

## Interleavingの解釈

なぜインターリービング（マルチリービング）が**通常のA/Bテストよりも感度が高く**なるか = **1人のユーザーが何度も複数の選考リスト(各アルゴリズムによる推薦結果)を評価する**ことになるから...??

# 各手法の概要
- Balanced interleaving
  - 「2つのランキングから**交互に**検索結果を最上位から順に選択し1つのランキングを生成する」インターリービング手法。
- Team draft interleaving
  - 「2つの検索結果を選ぶごとに**先攻・後攻をランダムで決めながら**、両ランキングから1つずつ、まだ用いられていない検索結果を上位から順に選択していく」インターリービング手法
- Probabilistic interleaving
  - 「できるだけ各ランキング中の検索結果の順序を保持しつつも、相対的に低い確率で任意の順序での検索結果選択を許容する」インターリービング手法。
- Optimized interlaving
  - 「いくつかの制約のもと、生成されるランキングの感度の期待値を最大にするようなランキング提示確率を用いる」インターリービング手法。

## 
