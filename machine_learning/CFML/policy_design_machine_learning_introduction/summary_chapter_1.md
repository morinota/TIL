# Bayesian Personalized Ranking from Implicit Feedback

published date: hogehoge September 2022,
authors: Wondo Rhee, Sung Min Cho, Bongwon Suh
url(paper): https://arxiv.org/ftp/arxiv/papers/1205/1205.2618.pdf
(勉強会発表者: morinota)

---

## どんなもの?

- ビジネスにおいて、データやアルゴリズム、機械学習を用いた施策の導入が広く行われている。
- しかし多くの場合において、MLの予測精度を高める事にのみ過度の注目が集まり、"MLが機能する為の前提を整える"ステップが見逃されてしまっている。
- 本chapterでは、ビジネスにMLを適用する上での代表的な落とし穴の存在と、それが施策の性能に及ぼす影響についてまとめる。
- また、ML施策を適用する上であるべき実践手順のフレームワークを提案する.

## 先行研究と比べて何がすごい？

論文ではなく技術書なのでパスします...!

## 技術や手法の肝は？

本書では、**ビジネス*ML施策への実践手順**に有用なフレームワークを提案していました。
ステップは以下の5つ:

- 1. KPIを設定する
- 2. データの観測構造をモデル化する
- 3. 解くべき問題を特定する
- 4. 観測データのみを用いて問題を解く方法を考える
- 5. 機械学習モデルを学習する
- 6. 施策を導入する

### ステップ1. KPIを設定する

KPIを設定する、というのはMLに限らずビジネス施策において自明な内容なのかもしれませんが、自分としては色々と学びがありました。
また、安易に扱いやすく計測しやすいmetricをKPIとする事への注意喚起もありました。(計測しづらいmetricを選べ、という事ではないです!)

推薦機能の場合、最終目的としては「ユーザ体験を向上させ、より多くのユーザにサービス利用を継続してもらう」「より多くのユーザに推薦機能を活用してもらう」事があると思います。ただこれらは観測するのに長い期間を必要とするため、短期的に観測できる代替metricsとしてCTRやtap数がよく用いられます。

ここで重要なのは、「その計測容易な代替metricsが、最終目的の達成度合いと相関(positiveもしくはnegativeな相関を想定。基本的には線形的な相関の方がいいだろうなー)があると見なせるか否か」という事だと感じました。
例えば動画推薦の機能において、ユーザの大半がある動画をtapしたとしてもすぐに興味を失って他の動画に移ってしまうような推薦機能、CTRやtap数は高くなっても必ずしもユーザ体験が向上しているとは言えません。
このような状況でCTRをKPIとして、CTRを最大化するようなML施策をリリースしたとしてもユーザの早期離脱を更に促進してしまうかもしれません。
この場合は動画の視聴時間の方が、ユーザ体験の向上度合いを代替する上でより有用なKPIかもしれません。

### ステップ2. データの観測構造をモデル化する

- 次のステップは、手元にあるデータがどのような経緯を辿って観測されたのかをモデル化(=記号や関係式を用いて表現)する事。
- データの観測構造は、サービスのUI等の個別の状況に強く依存する。
- ex1. 推薦位置によって観測されるデータと真にモデル化したい嗜好度の傾向に乖離が生じる(推薦位置が下にあるアイテムは、ユーザの嗜好度が高くともtapされる確率は低い傾向) = ポジションバイアス
- ex2. 2つの推薦アイテムを大画面に表示するUIの場合、絶対的な嗜好度合いでなく相対的な嗜好度合いにもとづいてユーザがtapし、データが観測される。
- ex3. 観測されているデータは、現在稼働している施策の影響を受けている。
- ↑のようなデータの観測構造やそれに伴い発生するバイアスを考慮して、以降のステップを設計していく。

### ステップ3. 解くべき問題を特定する

- データの観測構造をモデル化した後にすべきなのは、解くべき問題を特定する事
- MLの学習は、予め設定された目的関数に基づいてモデルパラメータを最適化していく。
- 「MLによって解くべき問題を特定する」＝「モデルパラメータを最適化する為の目的関数を定義する」
- むやみやたらに有名な目的関数を模倣するのではなく、事前に設定したKPIやデータの観測構造に基づいて、解くべき問題や目的関数を柔軟に設定できる事が重要。
- ↑を意識しない場合、目的関数についてより良い性能を発揮させる技術に詳しくとも、本番リリース後に最終目的を達成し得ないモデルを作ってしまうケースがある。

### ステップ4. 観測データのみを用いて問題を解く方法を考える

- 解くべき問題を、手元にある観測データのみを用いて近似するステップ。
- 解くべき問題=前のステップで定義した目的関数を直接最適化する事はほぼ不可能。
- 我々は、母集団から何らかの方法でサンプリングされた有限の観測データしか取得できず、母集団の分布を直接知ることはできないから。
- 教師ありMLでは、**Empirical Risk Minimization(ERM, 経験損失最小化)**という枠組みを採用している。(この用語知らなかった...! MLでは、特に母集団とか意識してなかったー)
- 観測データを用いて計算された目的関数の推定量が、**真の目的関数の一致推定量か否か**(一致性の仮定を満たしているか)を慎重に検討する事が重要...!
- 過去の施策やUIに起因する様々なバイアスの存在により、観測データから真の目的関数を容易に推定できないケースがほとんど。
- 従って、真の目的関数(i.e. MLモデルの性能)$J(\pi_{\phi})$をより正確に近似できるように、手元の観測データを使った目的関数(i.e. MLモデルの性能)の推定量$J\hat{J}(\pi_{\phi}; D)$を設計できる技術が重要...!

## どうやって有効だと検証した?

論文ではなく技術書なのでパスします...!

## 議論はある？

## 次に読むべき論文は？

## お気持ち実装

論文ではなく技術書なのでパスします...!
