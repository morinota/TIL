
伝えたいメッセージをピラミッド原則にしたがって整理してみる。

## まずOPQ分析  

OPQ分析で読み手の関心・疑問を整理してみる。

- Objective(望ましい状況): 
  - Text2SQLアプリケーションが実現され、社内のデータ分析が効率化・高速化・標準化・民主化されていること。
    - より具体的には、アナリスト&エンジニアの分析業務が効率化・高速化されること。また、普段分析業務に関わらない人でも簡単に分析ができるようになること(民主化、標準化)。
- Problem(問題, 現状とObjectiveとのギャップ):
  - LLMは一定普及したが、社内のデータ分析業務は依然としてアナリスト&エンジニアの手作業に依存している。データ分析の知識は属人化している。
    - 「どこにどんなデータがあるか?」という知識、A/Bテストの効果検証方法などの統計的な知識、etc.
- Question(読み手の疑問): 
  - どうしたらText2SQLを社内に導入して、それが価値を発揮し、社内のデータ分析業務を効率化・高速化・標準化・民主化できるのか?? なぜまだ導入できてないのか??
      
## 主メッセージを考えてみる!

主メッセージは、読み手のQに直接答えている必要がある。

- 主メッセージ: 価値を発揮するText2SQLアプリケーションを作るには...
  - クエリ実行履歴とContext Constructionできる基盤さえあれば、一定品質は担保できる感!
  - より価値を発揮するには、ワークフローを制御してあげる必要はありそう。

とりあえず2つメッセージが出てきてしまってるが、一旦OKとみなして、次に行こう。
この2つの主メッセージをサポートするサブメッセージを考えてみる。
(ある1階層に列挙するサブメッセージの数は5つを上限としよう...! そうなるようにグルーピングする:thinking:)
(基本的には根拠を列挙するイメージで、サブメッセージを考えてみる。5個を超えてしまう様であればグルーピングする...!:thinking:)

- 主メッセージ1のサブメッセージ
  - 前提としてcontext constructionは必要。
  - テーブルメタデータ整備はとりあえず頑張りすぎなくて良さそう。
  - context constructionの精度向上は iterative & incremental にやれば良さそう。
- 主メッセージ2のサブメッセージ
  - 品質向上には、context constructionの前後で色んなコンポーネントが必要そう。
    - context constructionの前の追加コンポーネント
    - context constructionの後の追加コンポーネント
  - LLMにSQL実行権限を与えたい場合は特に、ワークフローを制御してしっかり検証させてあげたほうが良さそう。
  - agentic度合いを高くすべきではなさそう。

- 意識すべきtips
  - 主メッセージは、読み手のQに直接答えている必要がある。
  - ピラミッド作成時のtips
    - メッセージを書くときは1つの考えを短く明快に。
      - 要約メッセージの4つの鉄則
        - 名詞表現、体言止めは使用禁止
        - 「あいまい言葉」は使用禁止
        - メッセージはただ一つの文章で表現すること
        - 「しりてが」接続詞は使用禁止
      - 主メッセージとキーライン(=主メッセージを支持するサブメッセージ)は、仮で良いので早い時点で決める! 「大枠から詳細へ」がピラミッド作りの基本!
      - ピラミッド作成時には文書を書いてはいけない! 
        - 「文書を書くプロセス」と「考えを組み立てるプロセス」を分けるのがピラミッド原則の最大の特徴...！
        - ピラミッド内に書くのは「1つのメッセージ」である! この段階では文書を書くことは忘れて、考えを組み立てることに集中するべき！
    - ピラミッドを作る場合、下部は必ず複数メッセージになる。1対1の「ぶら下がり型ピラミッド」になってる場合は何かがおかしいかも...!

構成案
- はじめに
  - なぜ今回このトピックを喋りたいのか??
  - Text2SQLとは何か?? どういうモチベーションでText2SQLをやりたいの??
  - 最初に参考文献達を共有しておく
-  
- 共有したいポイント1:
  - まず前提としてテーブルメタデータの整備は一定投資が必要っぽい。
- 共有したいポイント2: 
  - LLMの事前学習した知識には自社のDWH事情は含まれないので、当然context constructionは必要。context constructionの方法としてRAGなどが一般的。
  - context constructionをより良い感じにやる工夫たち。
- 共有したいポイント3:
  - context construction(i.e. RAG)だけを頑張ればもうOKなのか??
    - これだけでOKだったら、RAGの検索部分だけを提供するMCPサーバーで十分そう。
  - 事例によっては、生成したSQLクエリの実行計画を取得させたり、レビュアーLLMを用意して、SQLクエリを精錬してたりする。
  - この辺りのワークフロー(処理の流れ)は、一定我々が制御しておいた方が良さそう?? あまりにLLM側のAgentic度合い(ワークフローを自由に決められる度合い)を高くしちゃうと、この辺り扱いづらそう...??
- 自由研究して今どんな感じか??
  - hogehoge
- 今困ってること: 社内メンバーに使ってもらってFB欲しいけど、どうやれば良いねん??
  - エンジニアだけだったら...
    - ローカルMCPサーバー化してVSCode上で使ってもらえそう。
    - あるいはローカル環境でStreamlitアプリケーションを起動してもらえそう??
  - エンジニア以外のメンバーにはどう展開したら良さそう??
    - リモート環境に社内限定アクセスのStreamlitアプリケーションを立てる??
    - あるいは、社内のSlack上で使えるようにする?? 
-->


## ピラミット構造の型について

- ピラミッド構造の決定要素は、以下の3つ。
  - 第一: 読み手の疑問
  - 第二: 表現スタイル
  - 第三: 考えの構造
  - (**特に第一の要素が決まれば、第二・第三の要素はほぼ自動的に決まる**。)
- 第一の要素: 読み手の疑問の3分類
  - 「状況判断の疑問」: 状況判断を問う疑問。
    - 「これは問題か?」
    - 「どのような問題が存在するのか?」
    - 「どこに問題があるのか?」
    - 「なぜ問題があるのか?」
  - 「解決方針の疑問」: 問題解決の基本方針や戦略の決定/選択に関する疑問
    - 「問題を解決するために何ができるか？」
    - 「どうするのが最善か？」
  - 「解決行動の疑問」: 問題解決の具体的行動に関する疑問
    - 「具体的にどう実施すべきか？」
- 第二の要素: 考えの表現スタイルの2分類
  - 状況表現(Descriptive)
    - (状況は)...である
    - (状況は)...になるだろう
  - 行動表現(Prescriptive)
    - (解決のために)...すべきである
    - (解決のために)...することが必要である
    - (解決のために)...しなければならない
    - (解決のために)...してほしい
    - (解決のために)私は...します
- 第三の要素: 考えの構造の2分類
  - WHY構造
    - 主メッセージの理由/判断根拠などを下部で説明する
  - HOW構造
    - 主メッセージの具体的行動を下部で説明する

- 3つの要素を踏まえたピラミッド構造の基本パターン3つ + 応用パターン1つ
  - 基本パターン1: 状況のWHY
    - 状況分析や問題分析の報告書で用いられるパターン。
  - 基本パターン2: 方針のWHY
    - 方針提案書や戦略提案書で用いられるパターン。
  - 基本パターン3: 行動のHOW
    - 事業計画書や行動計画書で用いられるパターン。
  - 応用パターン1: WHYとHOWの三段論法
    - 問題分析 + 行動計画を1つのレポートで報告する必要がある場合。
    - この場合は「状況のWHY」と「行動のHOW」を組み合わせて、三段論法的なピラミッドを作る。
