オフラインストアへ大量レコードを書き込みたい時の料金は実際課題になってるっぽくて、解消方法を提案してるブログがあった。
https://towardsdatascience.com/ingesting-historical-feature-data-into-sagemaker-feature-store-5618e41a11e6/#f950-d5882f6deacb

たぶんPutRecord API っていうのは「ただオフラインストアに書き込む」だけの機能ではないから、そこそこ料金がかかってしまうんだろうなと思った。
我々的には「ただオフラインストアに書き込む」だけでいいんだけど、たぶん実際には以下の色んなことをやってくれてそう:

- オフラインストアに書き込む。
- (オンラインストア有効化してる場合) 書き込みリクエストされた特徴量レコード達のtimestampを見て、オンラインストア上の同一レコードとtimestampを比較。最新のものをオンラインストアに書き込む。
- (オンラインストア有効化してる場合) オフラインストアとオンラインストアの整合性チェック。オンラインストアには最新ver.のレコードのみが、オフラインストアには最新 & 古いver.のレコードが存在することを保証。

たぶんこんな感じで、オンラインストア有効化してる場合は色々やってくれるから、これくらい料金がかかるのは納得感(DynamoDBへの書き込み料金くらい? まあ実際Sagemaker Feature StoreのオンラインストアはDynamoDBを使ってるっぽいのでそりゃそうかも)。
しかし、オフラインストアしか使わない場合は、PutRecord APIの値段に見合う恩恵を享受できてない感。

ただそもそもオンラインストア有効化してるケース(=つまりリアルタイム推論を行うケース)だとしても、「ただオフラインストアに書き込む」機能は全然必要になりそう。
というのも、過去のtimestampの特徴量レコードをbackfillしたい時が結構ありそうなので。新しい特徴量を試したい時とかは、学習データセットを作るために過去のtimestampで特徴量作成しておきたかったりする。
この場合、最新のtimestampのレコードじゃないのでオンラインストアに書き込む必要がない。ここで`PutRecord API`を使っちゃうと無駄に料金がかかっちゃう感。
「試しに新しい特徴量を使って学習したい!」って時にbackfillして書き込み料金が数千円くらいかかる、っていうのは、試行錯誤のハードルを上げてしまうので避けたい。