---
marp: false
theme: gaia
_class: lead
paginate: true
backgroundColor: #fff
backgroundImage: url('https://marp.app/assets/hero-background.svg')
---

<!--
headingDivider: 1
-->
<!-- ![bg left:40% 80%](https://marp.app/assets/marp.svg) -->

# GIS group semi

Morita Masato
2022~

# 2022/04/12

## 前回まで(前年度まで)の進捗

- ストックの現役/退蔵（=建築物ストックの利用状況の違い）を考慮したMSFA
  - （利用の観点からの"ストックの質"）
  - 各建築物ストックが退蔵する確率を予測(記述?)する、退蔵確率モデル。
- ストックの退蔵化(解体されないケース)を考慮した、ストックの滞留年数の予測.
  - 各建築物ストックが解体される確率を予測する、解体確率モデル。
- 福岡県北九州市の各建築物ストックに対して、滞留年数および退蔵ストック化するかどうかの将来シミュレーション。
  - あ

## 今年度以降の研究の方針

### 目的

- ストック型社会に向けた**退蔵ストックの発生メカニズムの解明**と 、 ストックの退蔵を含めた都市物質代謝の将来予測モデルの構築。
- 更に、持続可能な都市構造の検討を目指す。

### アプローチ

- 項目１：画像情報及び位置情報による退蔵ストック検出 (1 年目～2 年目前半)
- 項目２：滞留年数や退蔵ストック発生に関するストック間の空間的相互作用のモデル化(2 年目前半～後半)
- 項目３：ストックの退蔵を含んだ都市物質代謝の将来予測モデルの構築(2 年目後半～3 年目後半)

大体1年目に項目(1)、2年目に項目(2)、3年目に項目(3)という流れ。（前倒しになると思います）

```mermaid
gantt
    title 研究計画
    dateFormat YY/MM
    axisFormat %y/%m

    項目（１）:22/04, 23/07
    項目（２）:23/04, 24/04
    項目（３）:24/02, 24/10
```

<!-- ```mermaid
gantt
    title 研究計画
    dateFormat YY/MM
    axisFormat %y/%m

    section 項目（１）
    環境構築・アルゴリズム理解    :a1 ,22/04,50d
    現地調査    :a2 ,22/05 ,10d
    アノテーション作業:a3 ,after a2 ,10d
``` -->

```mermaid
flowchart LR
    subgraph 項目1
    id0(車上カメラの映像から<br>学習データ生成) -- Faster R-CNN? -->id1
    id1(画像情報and位置情報<br>から退蔵ストック検出) -- 位置情報を元に<br>GISデータ化? --> id2(退蔵ストックGIS<br>データベースの拡張)
    end
    id1.->id7(Google Street View等から画像を取得できれば...<br>退蔵ストック検出を全国に拡大できる?)

    subgraph 項目2
    id2 --Spatial Durbin<br> Model? -->  id3(退蔵ストック発生に関する<br>空間的相互作用のモデル化)
    id2 -- Spatial Durbin<br> Model?--> id4(滞留年数に関する<br>空間的相互作用のモデル化)
    end

    subgraph 項目3
    id3 --乱数生成?--> id5(ストックの建て替わりと<br>利用状況の変化<br>のシミュレーション)
    id4 --乱数生成?--> id5
    end

    id3.-推定されるパラメータを解釈.->id6
    id4.-推定されるパラメータを解釈.->id6
    id5.-複数のシナリオで比較.->id6(どんな都市構造が<br>退蔵ストックの抑制や<br>滞留年数延伸に寄与する?)
```

兎にも角にも、まずは「項目１：画像情報及び位置情報による退蔵ストック検出」に着手していきます。

## 今週の進捗

「項目（１）：画像情報及び位置情報による退蔵ストック検出」における手順を整理すると、以下のようになる？

1. 現地調査によって、車上カメラから建築物の外観を撮影＝＞位置情報付の、建築物の外観の画像データを取得。
2. 撮影した画像に対して、アノテーション作業＝＞学習データを生成。
   - (ex. 画像のどこに物体があるか、その物体は何か、等の情報を各画像に付与する。)
3. 学習データを用いて、画像認識・物体検出モデルを生成。
4. 生成したモデルを、任意の建築物の外観の画像(位置情報付)に適用。その中から「退蔵ストックが検出された画像」を抽出。
5. 「退蔵ストックが含まれる画像」に付与された位置情報を元に、GISデータ化
6. GISデータ化されたものを、都市構造物GISデータと結合。

### 今週は、手順3「学習データを用いて、画像認識・物体検出モデルを生成。」を試してみた。

試しに、小麦の画像の中から、小麦の穂の部分を検出するモデルを生成してみた。

学習データは、以下のような画像＋赤いboxの座標4点()のセット。
![](<../images/image_and_bboxes_0%20(1).jpg>)

![](<../images/image_bboxes_onlyactual_0 (1).jpg>)

## 先生方からのコメント

- 全体のアウトプットの掃出しイメージ。
  - 退蔵ストックの検出。
  - ストック自体のボリュームも分からないと。材料が使われてる。
  - 画像データを建物工法を当てる為にも使える？(＝GISデータの欠損を補う)
  - イギリスの研究もやってる？Google Car。
  - 退蔵ストックが分かった後、廃棄物政策に絡めるには、重量のデータが必要。
  - アウトプットをどこにはきだすか。蛭田先生と一緒に考えて貰う？
  - どういう流れで研究をやってるかを理解する。
- 画像データから得られた出力値を、更に地理的・社会的情報と一緒にインプットするタイプでも面白いかも。

# 2022/04/18

## 前回の進捗

- 新年度の研究計画の整理
- Faster-R CNNを用いた物体検出モデルの実装(試しにオープンソースの画像データを用いて)

## 今週の進捗

- 見せれる報告資料はなし。物体検出アルゴリズムの情報収集。
- 「手法」の部分にフォーカスしすぎず、最終的なアウトプット＝「目的」の部分もしっかり意識するように。

## 今後の予定

- 物体検出アルゴリズムの情報収集を継続。
- 現地調査(=映像データ収集)に関しても、具体的に準備を進めていく
  - 360度カメラの撮影テスト、映像データ(位置情報付)の操作・抽出のテスト。
  - 現地調査の対象地域の選定
  - ,etc.

## アドバイス

- 長尾先生との連携.
  - Glass wallの話＝＞全国拡張。
  - Glass Wallに限った話ではないが、どうせ空き家が分かった後、重量を推定するには、構造の判定をする必要がある。
    - ＝＞退蔵/現役を考慮したMS推計を全国展開するには、建物工法の情報も推定する必要がある！
    - 空き家モデルの全国展開を見越すと、建物工法の判定を含めた方がいい！
- 土木は

# 2022/05/24

## 前回まで(前年度まで)の進捗

## 今週の進捗

- 学振 申請書の執筆作業(学内締め切り5/26)
- ISIE-SEM Conferenceの口頭発表(修士研究の内容)がaccept
- 修士研究の内容をどうにか論文化する必要がある??(ISIE-SEM Conferenceの前に...)
  - 投稿雑誌(Journal)の選択：
    - Scope(どのような論文を求めているか)を読んで決める？？
    - Environmental Science & Technology
    - **Journal of Industrial Ecology**
    - Resources, Conservation & Recycling
  - 学術論文の形態(Paper Style)の選択
    - Regular Article （通常の学術論文）かレター（Letter）
    - 現在進行系の研究成果(D1～の研究に繋がる)なので、**レター論文の方がいい**?

## 今後の予定

- 学振提出
- 修士研究の論文投稿
- 北九州市での画像データ収集

# 2022/05/31

## 前回までの進捗

- 学振 申請書の執筆作業(学内締め切り5/26)
- 修士研究の内容を論文化し始める

## 今週の進捗

- 修士研究の内容を論文化作業
  - 既存研究のサーベイ
- Inuse / Obsolete の画像認識モデル
  - 元々の自分の考えでは...
    - 車上から撮影された画像から、まず「画像の中の、建物を検出」して、その後「その建物が現役/退蔵かを分類」するタスク。
  - Zhiweiさんからのアドバイス
    - まず初めに、後者のタスク「その建物が現役/退蔵かを分類」を試してみては？発展として、前者のタスクも含めてみては？
      - ＝すなわち、予め「建物が一棟 写っている画像」を用意して、その画像(=建物)が「現役/退蔵かを分類」するタスク

なので、建物が写った画像を「現役/退蔵かに分類」するタスクを、「データ読み込み=>データの加工=>モデルの学習=>未学習データに対する推論」まで、一連の処理を実装してみる。(一連の処理がすでに実装できていれば、現地調査を経て実データを作成した後、すぐにモデリングに回せる)

- 2種類(現役 & 退蔵)の建物の画像を用意。

  - 実際には、現地調査で得られた車上カメラからの映像から、画像を切り出して、各画像を「現役」「退蔵」に分類しておく。
  - 今回は、以下のサンプル画像を**学習用データ**として用意して、一連の処理を実装してみる。

    - 現役ストック
      - ![](1.JPG "キャプションテキスト")
      - ![](2_inuse.JPG)
    - 退蔵ストック
      - ![](2.jpg "キャプションテキスト")
      - ![](1_obsolete.jpg)

  - また同様に、**検証用データ(学習に使用しないデータ)**として以下のサンプルを用意。検証用データを用いて、分類モデルの汎化性能(=未学習データに対するモデルの性能)を評価する。
    - ![](1_valid.JPG)
    - ![](2_valid.JPG)
    - ![](3_valid.jpg)
    - ![](4_valid.jpg)

- 画像データのData Augmentation(データ量の水増し)

  - Data Augmentation：
    - 既存のデータセットからデータ数を拡張する方法論。
    - ex)画像の水平反転、輝度変更, etc.
  - zhiweiさんからのアドバイス：
    - 分類タスクでは、分類対象の各クラス(ex. 現役, 退蔵)のデータ数が大きく異なる(ex. orderが10000と100, etc.)と、学習が上手くいかない。
    - ＝＞何らかの工夫が必要
  - ＝＞特に本研究「退蔵ストック検出」の場合、**退蔵ストックの数が現役ストックの数に比べて少ない**。(2020年の現地調査においても、現役ストック約2000棟、退蔵ストック約70棟)
    - Data Augmentationを用いて、データ数の差を補う事で対処可能？
    - ex)
      - ![](2_0horizontal_frip.jpg)
      - ![](2_0random_perspective.jpg)
  - 上記の処理を、画像認識の一連の処理の中に挟む。
    - 「データ読み込み=>データの加工(+「退蔵」クラスに関してはデータ拡張)=>モデルの学習=>未学習データに対する推論」

- 現役/退蔵の画像認識モデルを学習させてみる。
  - 結果(20 epoch = 学習用データを20周学習)
    - 正解率(正解数/全画像数): 学習用データ=0.9019, 検証用データ= 0.7500
    - 1 epoch毎の
    - ![](recording_loss_acc.png)
  - => 今回は、Google street viewから拾ってきた数枚の画像のみで学習させた為かなりラフだが、外観から判断できる現役/退蔵は、画像認識モデルによってある程度(8割弱)判定できそう?
  -

```
image_recognition_obsolete_or_inuse
├─images_inuse_obsolete
│  ├─train (ここに学習用画像を入れる)
│  │  ├─inuse
│  │  └─obsolete
│  └─valid (ここに検証用画像を入れる)
│      ├─inuse
│      └─obsolete
└─judge_obsolete_inuse
    └─__pycache__

```

## 今後の予定

- 修士研究の論文投稿(7月中の投稿)
- 北九州市での画像データ収集
  - カメラの操作方法を確認
  - 調査実施場所の選定
  - (東さんとコンタクトを取りつつ、実施時期・場所の計画, 6月実施を目指す)

## アドバイス

- ほぼ同じ事を長尾先生もやってる?連携させてやらないと
  - 長尾先生と話??
- 調査に関しても
  - データを闇雲にとっても..
  - これも長尾先生と話?
- 物体検出用のライブラリはすでに出てる
  - どんなライブラリを使う?
  - 技術も身につくし、業績にもなるような事を相談?
- 学習データに関しては、難易度の高いものを入れたほうがいいかも。
  - 今回のサンプルの例だと、和風vs 洋風みたいな感じにもなってる.
- 長尾先生と打ち合わせの調整できませんか??
  - 長尾先生は画像分析の方からアプローチ?
  - 自分は地理情報からのアプローチ??
  - 画像データだけでは難しいから…地理情報も含める??
- 画像認識モデルの結果=>変数に。
- 東さんがGoogle Earthで色々画像を集めてくれてる?=>後で共有してくれる.

# 2022/06/14

## 研究テーマ

### 目的

- ストック型社会に向けた**退蔵ストックの発生メカニズムの解明**と 、 ストックの退蔵を含めた都市物質代謝の将来予測モデルの構築。
- 更に、持続可能な都市構造の検討を目指す。

### アプローチ

- 項目１：画像情報及び位置情報による退蔵ストック検出
- 項目２：滞留年数や退蔵ストック発生に関するストック間の空間的相互作用のモデル化
- 項目３：ストックの退蔵を含んだ都市物質代謝の将来予測モデルの構築

## 前回までの進捗

- 修士研究の内容を論文化し始める
- 退蔵/現役の画像認識モデルを実装してみた

## 今週の進捗

見せられる結果は特になし。

- 修士研究の内容を論文化作業
  - 既存研究のサーベイ
- 長尾研究室との連携
  - 今週末に打ち合わせを予定
  - 退蔵/現役に関する画像認識/物体検出モデルの実験の情報共有
  - 今後の研究計画と現地調査の計画に関して相談。
- 画像認識/物体検出の出力結果に対して、地理情報データを結びつける方法に関して
  - 方法1: 
    - 元々、研究計画の際に想定していた方法
    - 外観情報ベースと位置情報ベースでそれぞれ、退蔵/現役を予測するモデルを構築=>それらの出力値の平均(重み付け)を最終的な出力値に。
    - ![](img/画像×位置_方法1.drawio.png)
  - 方法2
    - 外観情報ベースで教師ありモデルを構築。＝＞その出力値(外観からの判定結果)を特徴量の一つとして、人口情報・地理的条件, etc.と一緒に教師ありモデルを構築=>最終的な出力値(判定結果)。
    - ![](img/画像×位置_方法2.drawio.png)
  - 実験して精度が高い方法を選択する? 解釈しやすい方法を選択する?

## 今後の予定
- 今週金曜, 長尾研究室との打ち合わせ
- 修士研究の論文投稿(7月中の投稿)
- 北九州市での画像データ収集(6月中を想定)
  - カメラの操作方法を確認
  - 調査実施場所の選定
  - (東さんとコンタクトを取りつつ、実施時期・場所の計画, 6月実施を目指す)


