## 一つのAWS VPCは、一つのIPアドレスを持ちますか?

- いいえ。VPCは多くのIPアドレスを包含できる。
  - VPCはユーザーがAWS内で定義できる仮想ネットワーク空間。
  - VPC内では、1つ以上のサブネットを作成し、それぞれのサブネットには一つ以上のIPアドレス範囲が割り当てられる。
  - -> 、一つのVPCは複数のIPアドレスを持つ。
- VPCの設定時にできること
  - IPアドレス範囲をCIDRブロックを使用して指定できる。
  - 複数のサブネットを作成し、異なるサブネットに異なるIPアドレス範囲を割り当てることができる。

## 1つのAWS subnetは、1つのIPアドレスを持ちますか?

- いいえ。AWSのサブネットも複数のIPアドレスを持つ。
  - サブネットはVPC内に作成される、IPアドレスの範囲を持つネットワークセグメント。
  - サブネット作成時には、それが属するVPCのIPアドレス範囲から更に小さなCIDRブロックを指定して、そのサブネットのIPアドレス範囲を定義する。
  - よって、**VPC内のsubnetのIPアドレス範囲は、VPCのIPアドレスの範囲の部分集合**になる。
  - subnet設定時のルール:
    - 複数のサブネットの範囲はVPCの範囲内で重複しないべき。
    - VPCのIPアドレス範囲を超えるようなサブネットは作れない。

## CIDRブロックの読み方難しい問題:

- CIDR（Classless Inter-Domain Routing）表記:
  - IPアドレスの範囲を効率的に指定する方法
- 解釈の仕方: VPCのCIDR`10.0.0.0/16`と、subnetのCIDR`10.0.1.0/24`を例に:
  - `10.0.0.0`や`10.0.1.0`の部分は、IPアドレス範囲の先頭アドレスを表す。
  - `/16`や`/24`の部分は、IPアドレス範囲の長さに関する情報。(**値がそのまま長さではない点に注意**!)
    - **IPv4アドレスは32bitで表現される**(2^32通り)。
    - `/16`の場合は最初の16bitが固定されている事を意味する。
      - -> 残りの32 - 16 = 16bitをホスト毎に割り当てる事ができるという範囲を意味する。
      - (よって、2^16通りのIPアドレスがVPCのIPアドレス範囲になる...!)
      - 具体的には`10.0.0.0`を範囲の先頭として`10.0.255.255`までの2^16 = 256^2 通り。
    - 同様に、`/24`の場合は、最初の24bitが固定されている事を意味する。
      - -> 残りの32 - 24 = 8bitをホスト毎に割り当てる事ができるという範囲を意味する。
      - (よって、2^8通りのIPアドレスがsubnetのIPアドレス範囲になる...!)
      - 具体的には `10.0.1.0`を範囲の先頭として`10/0.1.255`までの2^8 = 256通り。
- つまり、CIDR表記において、**スラッシュの後の数値が大きいほど、そのサブネットはより小さな範囲のIPアドレスを持つことになる**。
- CIDR表記: `{IPアドレス範囲の先頭}/{固定されているbit数}`
