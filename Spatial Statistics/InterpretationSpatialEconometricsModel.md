# イントロダクション

## 空間情報(クロスセクション含む)の自己相関の理解が浅い話

## 空間的な自己相関が存在する

## 今回想定する例題

今回はヘドニック回帰(hedonic Regression)(＝基本的な線形回帰??)を例題として取り上げているが、紹介する手法群は様々な問題に適用可能。

- Hednic理論：
  - ミクロ経済学の理論。
  - 「品質によって財やサービスの値段が変わる。そうした品質の違いを前提に、需要と供給を考えましょう」みたいな理論。
- ヘドニック回帰：
  - ｙ(財やサービスの価格)、X(財やサービスの品質・特徴を表す変数)の関係を回帰分析で表すこと？
  - yはリンゴでも住宅でもOK!価格なら！

以下の章では、自己相関構造のモデル化に関わる基本的な問題を議論し、最も一般的に使用されている手法を比較対照する。

# 空間的自己相関のモデル化方法

空間的自己相関のモデル化には、一般的に2種類の方法がある。

- 1. (誤差項を生成する)プロセス自体をモデル化する方法。
  - 地理学者geographers(Cliff and Ord, 1981)の研究に基づく。
  - **重み行列weight matrix**を使用する必要がある。
  - Spatial Econometricsの文献では、より一般的なアプローチ。
- 2. 誤差項の共分散行列を直接モデル化する方法。
  - 地質学者geologistsの研究に基づく。

# (誤差項を生成する)プロセス自体をモデル化する方法

このアプローチでは、誤差項を生成するプロセスを明示的にモデル化する。このプロセスにおける最もシンプルなモデルは以下。

$$
Y = X \beta + \mathbf{u} \tag{1.a}
$$

$$
\mathbf{u} = \lambda W \mathbf{u} + \mathbf{\epsilon} \\
(\epsilon_i \sim Norm(\mu = 0, \sigma^2))
\tag{1.b}
$$

- $\mathbf{u}$が$\mathbf{u}$自体によって影響を受ける、すなわち自己相関を持つ事を表す。
- 重み行列Wの主対角成分は0。つまり自分自身とは関係しない！他の要素と関係する！
- $u_i$が$\sum_{j=1}{W_{ij} u_j}$に依存する！
- これが上述した、"「誤差項ベクトルを生成するプロセス」をモデル化している"という意味！

## モデル式の解説:

- 回帰式(1.a)：
  - Y：住宅の販売価格を示すベクトル$\in \mathbb{R}^{N\times 1}$
  - X：住宅の特徴を表す行列$\in \mathbb{R}^{N \times K}$($K$は説明変数の数)
  - $\mathbf{u}$：空間的に相関する撹乱項ベクトル。$\in \mathbb{R}^{N\times 1}$
  - $\beta$：未知の回帰係数を示すベクトル $\in \mathbb{R}^{N\times 1}$
- 誤差項の相関関係を生成するプロセスを表す(1.b)
  - $\mathbf{\epsilon}$：各要素が独立した同一の一次元正規分布に従う誤差項ベクトル。
  - $\lambda$：未知の空間的自己相関パラメータ(スカラー)
    - つまり我々が最初に勉強した=空間的交互作用を考慮しないモデルは$\lambda=0$のケース！
    - $-1<\lambda<1$を仮定している。
    - 本論文では、プラスになる事=正の空間的自己相関が存在する事を期待する。
    - マイナスは珍しいらしい...。
      - ex)Aさんの家の値段が高い時、となりの家の価格が安い。
      - 自然界では起こりづらい?
  - $W$：データの空間構造(各観測地の空間的な関係)を表す重み行列$\in \mathbb{R^{n \times n}$

ここで分析者は、Wを事前に知っているものとみなしている。つまり、重み行列Wは推定すべきパラメータではなく、観測済みの値である。
従ってこの点で、**全ての分析結果は$W$の設定(特定)方法に依存**する！

- (例外としてPace et al 1998)
- このモデルは時系列のAR1モデルと似ている！
- また、時系列の場合と同様、様々な空間的なラグを用いる事でモデルを拡張する事ができる！

## 重み行列$W$の三種類の設定(特定)方法

重み行列Wは、このアプローチにおける最重要要素。

- Wは、主対角成分がゼロの、N×N行列。
- 非対角要素$W_{ij}$は、観察対象iとjの間の空間的関係を表す。
  Wの特定方法は主に三種類ある。

1. "最近傍Nearest Neighbors"を使用する方法
   - この方法(scheme)では、iとjが互いに最も近い関係にある場合に$W_{ij}=1$, それ以外の場合は$W_{ij}=0$とする
   - この手法は、1個の最近傍→n個の最近傍に簡単に拡張できる点が◎
     - ex. N-1個の内、iと最も近い上位n個のjに対してW_ij=1
2. 距離行列と閾値を元にした方法
   - iとjの間の距離が、事前に指定されたある閾値$L$よりも小さい場合に$W_{ij}=1$を設定する。
   - $W_{ij}=1 if D_{ij}\le L$
   - Dは距離行列。
3. 距離行列の逆数を元にした方法
   - Wの要素を2値化(0 or 1)するのではなく、$W_{ij}= \frac{1}{D^{p}_{ij}}$とする。
     - この場合、$W_{ij}>0$となる。
     - $p$は設定すべき定数。
   - 従って、観測地iとjの距離が近いほど、$D_{ij}$は小さく重み$W_{ij}$は大きくなる...！

上述した3つのW特定方法は、いずれも良く用いられるが、どの方法が住宅市場に表れる相関構造を最も良く実現しているかについては、合意が得られていない。
# 誤差項の共分散行列を直接モデル化する方法
