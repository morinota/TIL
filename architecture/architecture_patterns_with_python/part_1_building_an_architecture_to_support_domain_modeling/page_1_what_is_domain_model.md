## link

- https://learning.oreilly.com/library/view/architecture-patterns-with/9781492052197/ch01.html

## Chapter 1. Domain Modeling

- この章では、TDDとの互換性が高い方法で、コードを使用してビジネスプロセスをモデル化する方法について説明します.
- ドメインモデリングが重要である理由について説明し、ドメインをモデリングするためのいくつかの重要なパターンであるエンティティ、値オブジェクト、ドメインサービスについて説明します。
- 図1-1は、ドメインモデルパターンの単純な視覚的プレースホルダーです。
- この章でいくつかの詳細を入力し、他の章に進むにつれて、ドメインモデルを中心に構築しますが、これらの小さな形状は常にコアで見つけることができるはずです

![](https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492052197/files/assets/apwp_0101.png)

## What is Domain Model?

- 序章では、3層アーキテクチャの中心層を表すために、**ビジネスロジック層**という用語を用いた。
  - この本の残りの部分では、**代わりにDomain Modelという用語を使う**ことにする。
  - これはDDDコミュニティからの用語で、私たちの意図する意味をよりよく捉えている（DDDについての詳細は次のサイドバーをご覧ください）。
- Domain
  - Domain: **解決しようとしている問題**を表現するための凝った方法(??)
  - ex)
    - あなたの著者は現在、家具のオンライン小売業者で働いています。
    - 話しているシステムに応じて、ドメインは購入と調達、製品設計、またはロジスティクスと配送になります。
    - 多くのプログラマーは、ビジネスプロセスの改善や自動化に日々取り組んでいますが、**ドメインとは、それらのプロセスがサポートする一連の活動**のこと。
- "Model"
  - モデルは、有用なプロパティをキャプチャするプロセスまたは現象のマップ.
  - 人間は頭の中で物事のモデルを作成するのが非常に得意である。
  - ex)
    - たとえば、誰かがあなたに向かってボールを投げたとき、オブジェクトが空間内で移動する方法のモデルがあるため、ほとんど無意識のうちにその動きを予測することができる.
    - あなたのモデルは決して完璧ではない。
    - 私たちのモデルはこれらのケースをカバーするように設計されていなかったため、人間は、オブジェクトが光速に近い速度または真空中でどのように動作するかについてひどい直感を持っている。
    - これは、モデルが間違っていることを意味するわけではありませんが、**一部の予測がそのドメイン外にあること**を意味します。
- "Domain Model":
  - ビジネスオーナーがビジネスについて持っているメンタルマップ.
  - すべてのビジネスマンはこれらのメンタルマップを持っている—それらは人間が複雑なプロセスについて考える方法である.
  - このようなマップをナビゲートするとき、彼らはビジネス用語を使うのでわかる.
    - **専門用語は、複雑なシステムで共同作業をしている人々の間で自然に**生まれる(この専門用語に対する考えいいね...!!)
  - ex)
    - もし、あなたが不幸にも友人や家族と一緒に宇宙船に乗って地球から何光年も離れた場所に突然飛ばされ、どうやって家に帰ろうかと第一原理から考えなければならなくなったと想像してください。
    - 最初の数日は、ただやみくもにボタンを押すだけかもしれませんが、すぐにどのボタンが何をするのかを覚え、お互いに指示を出し合えるようになる.
      - 「点滅しているボタンの近くにある赤いボタンを押して、レーダー装置のそばにある大きなレバーを投げてください」と言うかもしれない.
    - 数週間もすれば、船の機能を説明する言葉を採用することで、より正確な表現ができるようになる.
      - 「貨物室3の酸素濃度を上げる" "小型スラスターをオンにする"。数カ月後には、複雑なプロセス全体を表す言葉を採用するようになる。"着陸態勢に入る "とか "ワープに備える "とか このようなプロセスは、共有の用語集を作るような正式な努力なしに、ごく自然に起こるものである。
- ビジネスのありふれた世界でもそうである。
  - ビジネス関係者が使う用語は、複雑なアイデアやプロセスを一つの単語やフレーズに煮詰めた、ドメインモデルの蒸留された理解を表している.
  - 私たちは、ビジネス関係者が聞きなれない言葉を使ったり、特定の方法で用語を使ったりするのを聞いたとき、深い意味を理解するために耳を傾け、**彼らが苦労して得た経験をソフトウェアにコード化する**必要がある.
  - この本では、実世界のドメインモデル、特に私たちが現在勤めている会社のモデルを使うことにする。
    - MADE.comは、成功した家具小売業者です。
    - 私たちは世界中のメーカーから家具を調達し、ヨーロッパ全土で販売しています。
    - ソファやコーヒーテーブルを購入する場合、ポーランドや中国、ベトナムから商品をどうやってリビングルームに運ぶのがベストなのかを考えなければならない。
    - 大まかに言えば、在庫を買うシステム、顧客に在庫を売るシステム、顧客に商品を出荷するシステムが別々に存在する.
    - 中間に位置するシステムは、顧客の注文に対して在庫を割り当てることで、このプロセスを調整する必要がある（図1-2参照）.

![](https://learning.oreilly.com/api/v2/epubs/urn:orm:book:9781492052197/files/assets/apwp_0102.png)

- 本書では、ある企業が在庫配分の新しい方法を導入することを決定したと仮定する.
  - これまで、在庫とリードタイムは、倉庫にある物理的な在庫に基づいて表示されていた.
  - 倉庫に在庫がなくなると、メーカーから次の出荷があるまで、その製品は「在庫切れ」と表示される.
- もし、すべての出荷とその到着予定日を追跡できるシステムがあれば、それらの出荷された商品を実際の在庫として扱い、リードタイムを少し長くするだけで、在庫の一部として扱うことができる。
  - 在庫切れの商品は少なくなり、販売量も増え、国内の倉庫の在庫を減らすことで経費も削減できる.
- しかし、オーダーの割り当ては、もはや倉庫システムで1つの数量をデクリメントするという些細な問題ではない.
  - もっと複雑な割り当てメカニズムが必要なのである.
  - ドメイン・モデリングの時間だ。


## This is Not a DDD Book. You Should Read a DDD Book.

- **Domain-driven design(ドメイン駆動設計, DDD)**は、ドメインモデリングの概念を普及させ、**中核となるビジネスドメインに焦点を当てる**ことで、**ソフトウェアを設計する方法を変革**し、大きな成功を収めた。
  - 本書で取り上げるEntity、Aggregate、Value Object（第7章参照）、Repository（次章参照）などのアーキテクチャパターンの多くは、DDDの伝統に由来するものである。
- DDDは、一言で言えば「**ソフトウェアで最も重要なことは、問題の有用なモデルを提供することである**」と言っている.
  - そのモデルが正しければ、ソフトウェアは価値を提供し、新しいことを可能にするのである.
  - モデルを間違えると、それが障害となり、回避することができなくなる.
    - 本書では、**ドメインモデルを構築し、そのモデルを中心にアーキテクチャを構築**することで、**モデルを外部の制約からできる限り解放**し、進化や変更を容易にするための基本的な方法を紹介することができる。
- DDDとドメインモデルを開発するためのプロセス、ツール、テクニックには、もっとたくさんのものがある。
  - しかし、私たちはその一端に触れるだけなので、適切なDDDの本を読むことをお勧めします。
  - The original “blue book,” Domain-Driven Design by Eric Evans (Addison-Wesley Professional)
  - The “red book,” Implementing Domain-Driven Design by Vaughn Vernon (Addison-Wesley Professional)
