## refs

- [Refactoring.io デザインパターン](https://refactoring.guru/ja/design-patterns)

# 構造に関するデザインパターン

## Facade(ファサード)パターン

### なにそれ？

- Facade(ファサード)は、建物の正面の意味。
  - 由来はフランス語で、英語のfaceと同じ意味。
- 複雑な外部サブシステム(=サードパーティのライブラリなど)への単純なインターフェースを提供することで、**対象システムと外部サブシステムとの間の密結合を避ける**ことを目的とする。
  - 外部サブシステムのバージョン更新や、他のサブシステムに置き換える場合は、Facadeクラスのメソッドの実装のみを変更すれば良い。
- 現実世界での例:
  - お店に電話して出前を注文する時の、**電話オペレータがFacadeに該当**する。
    - オペレータは、注文システム、支払いゲートウェイ、配達サービスなどを持つ複雑なサブシステムに対して簡単なインターフェースを提供する。

### 構成:

- Facadeパターンの構成:
  - 1. Facadeクラス:
    - サブシステムの機能の特定の部分への便利なアクセスを提供する。
    - クライアントからのリクエストを、サブシステムのどこにどう送り、どのような細かい操作をすれば良いのか熟知している。
    - サブシステムの複雑さに応じて、Additional Facadeクラスを呼び出す(i.e. 依存する)こともある?
  - 2. Additional Facadeクラス:
    - Facadeクラスの補助として、サブシステムの一部の機能に対する簡単なインターフェースを提供する。(**Facadeクラスの肥大化を避け、複雑さを低減することが役割?**:thinking:)
    - 他のFacadeクラスもしくは、クライアントから呼び出される。
  - 3. 複雑なサブシステム:
    - 何十もの様々なオブジェクトで構成される。操作するためには、それらの実装の詳細について熟知し、正しい順序でそれらを呼び出す必要がある。
    - サブシステム内のクラスは、Facadeクラスの存在を知らない(i.e. 依存していない?)。
  - 4. クライアント:
    - サブシステムのオブジェクトを直接呼び出す代わりに、Facadeクラスのメソッドを呼び出す。

### 使い所:

- 1. 複雑なサブシステムへの簡素で限定的なインターフェースが必要な場合:
- 2. サブシステムを多層構造にしたい場合:
  - サブシステムの各レベルへのエントリーポイントとしてFacadeクラスを定義し、Facadeを通してのみ通信可能にすることで、**複数のサブシステム間の結合を減らせる**。(1つのサブシステムに対してもレイヤー毎に使える?? 逆に、複数のサブシステムに対して1つのFacadeクラスで管理するケースもある??:thinking:)
    - ex.) recboleでいうと、DatasetクラスとDataLoaderクラスとTrainerクラスに対してそれぞれFacadeクラスを用意するケース??
  - ex.)サブシステム = 動画変換フレームワークの例:
    - 1つのサブシステムを、ビデオ関連とオーディオ関連の2つのレイヤーに分けることができる。
    - 各レイヤーに対してFacadeクラスを作成して、**各レイヤーのクラスがFacadeを介してのみやり取りできるようにする**。

### 特徴:

- 長所: サブシステムの複雑さからクライアントコードを分離できる。
- 短所: Facadeクラスが、アプリ(=クライアントコード??)のすべてのクラスに結合された神オブジェクトになる可能性がある。

### 他のデザインパターンとの関係:

- Adapterとの関連:
  - Adapterパターンは通常1つのオブジェクトだけをwrapするのに対して、Facadeパターンは複数のオブジェクトからなるサブシステム全体をwrapする。
- Abstract Factoryパターンとの関連:
  - **サブシステムがオブジェクトを作成する方法をクライアントから隠蔽することだけが目的の場合は、Abstract Factoryパターンを使うことができる**。
- Mediaterパターンとの関連:
  - FacadeパターンとMediatorパターンはともに、**多くの密結合したクラス間のコミュニケーションを組織化している点で共通している**。
    - Facadeパターンは、サブシステムへの簡略化されたインターフェースを定義するだけで、サブシステム内のオブジェクト同士は直接やり取りする。
    - Mediatorパターンは、システムのComponent間の相互作用を全てMediatorクラスに委譲する。
- Singletonパターンとの関連:
  - 多くの場合、特定のサブシステムに対するFacadeオブジェクトは1つだけで十分なので、Singletonに変換できる。
