# コンテンツベースフィルタリングとは

コンテンツベースフィルタリング（Content Base Filtering）とは、**アイテムの特徴をもとに、ユーザが過去に高評価したアイテムと似た特徴を持つアイテムをレコメンドする**手法。

コンテンツベースフィルタリングを実装する為のステップは以下。

1. アイテムの特徴をベクトル化
2. アイテム間の類似度の算出
3. 類似度行列を生成
4. 各ユーザが既に取引したアイテムに対して、類似度の高いk個のアイテムを取得
5. 各ユーザに対してレコメンド(既に取引してるアイテムを再度レコメンドするか否かはケースバイケース？)

# アイテムの特徴をベクトル化

アイテムのベクトル化は、後述するアイテム間の類似度を算出するために必要な処理。

アイテムのベクトル化とは、アイテムを何らかの特徴量で表現することを意味する。

- アイテムの**属性情報があればそのまま特徴量になる**
- アイテムを**説明するテキスト**があれば、**TF-IDF**によって特徴量とすることも可能。
  - TF-IDFはscikit-learnにあるらしい.
  - 
- アイテムの**画像**があれば、Encoder等を用いて画像特徴量を生成する事も可能。

ex)アイテムの属性情報
以下の様なデータ構造の場合、アイテムをベクトルとして利用できる。

| title                              | Comedy | Children | Romance | Adventure | Fantasy | Animation | Drama |
| ---------------------------------- | ------ | -------- | ------- | --------- | ------- | --------- | ----- |
| Toy Story (1995)                   | 1      | 1        | 0       | 1         | 1       | 1         | 0     |
| Jumanji (1995)                     | 0      | 1        | 0       | 1         | 1       | 0         | 0     |
| Grumpier Old Men (1995)            | 1      | 0        | 1       | 0         | 0       | 0         | 0     |
| Waiting to Exhale (1995)           | 1      | 0        | 1       | 0         | 0       | 0         | 1     |
| Father of the Bride Part II (1995) | 1      | 0        | 0       | 0         | 0       | 0         | 0     |

# アイテム間の類似度の算出

ベクトル間の類似度を測る指標はいくつか存在するが、その中でもよく使用される指標はコサイン類似度(Cosine Similarity)である。
コサイン類似度は1から-1の値をとり、ベクトルの長さに関係なく、ベクトルの向きが近いほど1に近づく。

2つのベクトル$x,y$のコサイン類似度は以下で定義される。

# 類似度行列の生成

コンテンツベースフィルタリングにおける類似度行列は、アイテム数×アイテム数の対象行列になる。
類似度行列の要素(i, j)は、アイテムiとアイテムjの類似度となる。

# 最後に　コンテンツベースの特徴

コンテンツベースフィルタリングでは**評価件数の少ないニッチなアイテムもレコメンドされる場合がある**。
これは、コンテンツベースフィルタリングでは**他のユーザのデータを一切使わずに、アイテムの特徴と似ているアイテムをレコメンドするため**である。

**アイテムの特徴量を正確に表現できているのであれば**、ユーザにパーソナライズしたアイテムのレコメンドが可能になる。

一方、アイテムの特徴量を正確に表現するためには深いドメイン知識が必要になる。

また、入力したアイテムの特徴と似ているアイテムだけをレコメンドするため、ユーザーがレコメンドされるアイテムに目新しさを感じずに、飽きてしまう可能性がある。

こういった課題を解決するためには、コンテンツベースフィルタリングだけではなく、他のレコメンドモデルもハイブリッドする必要がある。
# 便利ライブラリ?
- Surprise
- Turi Create
# 参考

- https://yolo-kiyoshi.com/2020/08/26/post-2234/
- 
