# 期待値・分散・共分散・標準偏差・相関係数・変動係数

## 期待値

確率変数Xの期待値をE[X]とすると...

$$
E[X]=\frac{1}{n}\sum{x_i} = \int_{-\infty}^{\infty}{x\cdot f(x)dx}
$$

期待値の一般解は...

$$
E_x[k] =
$$

また、期待値関連の計算式は以下。(全て上の期待値の定義式から導出できるはず...?)

$$
E[X+k] = E[X] + k \\
E[kX] = k\cdot E[X] \\
E[X+Y] = E[X] + E[Y] \\
E[X-Y] = E[X] - E[Y] \\
E[XY] = E[X]E[Y] + Cov[X, Y] \\
E[X^2] = E[X]^2 + V[X]
= \int_{-\infty}^{\infty}{x^2\cdot f(x)dx}
$$

## 分散

ある確率変数Xの分散をV[X]とすると、

$$
V[X] = \frac{1}{n} \sum{(x_i - E[X])^2} \\
= E[X^2] -E[X]^2 \\
= \sum_{i=1}{(x_i - E[X])^2 p(x_i)}
= \int_{-\infty}^{\infty}{(x_i - E[X])^2\cdot f(x)dx}
$$

また、分散関連の計算式は以下。(全て上の期待値や分散の定義式から導出できるはず...?)
(V[XY]はないんだ...E[XY]よりも難易度が高い?)

$$
V[X+k] = V[X] \\
V[kX] = k^2 V[X] \\
V[X+Y] = V[X]+ V[Y]+2 Cov[X,Y] \\
V[X-Y] = V[X]+ V[Y]-2 Cov[X,Y]
$$

## 共分散

確率変数X、Yの共分散をCov[X,Y]とすると、定義式は以下。

$$
Cov[X,Y] = E[(X-E[X])(Y-E[Y])] \\
= E[XY] - E[X]E[Y]
$$

また、共分散関連の計算式は以下。

$$
2Cov[X,Y] = V[X+Y] -V[X]-V[Y] \\
- 2Cov[X,Y] = V[X-Y] -V[X]-V[Y] \\
Cov[X,X] = V[X]
$$

## 標準偏差

確率変数Xの標準偏差の定義は以下。

$$
\sigma_x = \sqrt{V[X]}
$$

## 相関係数(ピアソンの積率相関係数)

確率変数X,Yの相関係数の定義は以下.

$$
r(X,Y) = \frac{Copv[X,Y]}{\sigma_x \sigma_y}
$$

## 変動係数(Coefficient of Variation)

- 標準偏差を平均値で割った値のことで、単位の異なるデータのばらつきや、平均値に対するデータとばらつきの関係を相対的に評価する際に用いる。
- 単位を持たない（＝無次元の）数値。
- 変動係数は一般にCVで表される。
  $$
  CV = \frac{\sigma_x}{\bar{x}} = \frac{\sigma_x}{E[X]}
  $$

## 標準化

確率変数の標準偏差を$\sigma_x$とすると、Xの確率分布を標準化した分布Yは..。

$$
Y=\frac{X-E[X]}{\sigma_x}
$$

で、標準化された分布の統計量は...

$$
E[Y] = 0\\
V[Y] = 1\\
\sigma_y =1
$$

## 独立な確率分布X,Yの場合

XとYが独立な時、

$$
Cov[X,Y] = 0 \\
P(X=x, Y=y) = P(X=x) \times P(Y=y) \\
同時確率が各確率の積で表せる。
$$

従って...。

$$
r(X,Y) = \frac{Copv[X,Y]}{\sigma_x \sigma_y} = 0 \\
$$

$$
E[XY] = E[X]E[Y] + Cov[X,Y] = E[X]E[Y] \\
$$

$$
V[XY] = V[X]V[Y] +E[X]^2V[Y] + E[Y]^2V[X]
\\
(証明)\\
(\because 分散と期待値の関係式より) \\
V[XY] = E[(XY)^2] - E[XY]^2 \\
(\because XとYが独立の場合の積の期待値より) \\
= E[(XY)^2] - E[X]^2 E[Y]^2 \\
(\because XとYが独立の場合、確率変数X^2とY^2も独立なので、E[(X^2)(Y^2)]は...) \\
= E[X^2]E[Y^2] - E[X]^2 E[Y]^2 \\
(\because 再度、分散と期待値の関係式 V[Z] = E[Z^2]-E[Z]^2を使って...) \\
=(V[X]+E[X]^2)(V[Y]+E[Y]^2) - E[X]^2 E[Y]^2 \\
これを展開すると\dots \\
= V[X]V[Y] + E[X]^2V[Y] + E[Y]^2V[X]
が示された。
$$

#

# 各種用語

## 歪度(わいど)

分布が正規分布と比べて左右どちらに偏っているかを表す。

正規分布では0。歪度が0なら左右対称。歪度が正なら右に、歪度が負なら左に裾が長い分布となる。
ここで、

- 「右裾が長い」＝「右にゆがんだ」＝「左に偏った」＝「歪度が正」
- 「左裾が長い」＝「左にゆがんだ」＝「右に偏った」＝「歪度が負」

サンプルサイズをn、各データ$x_i(i=1, 2, \cdots, n)$の平均値を$\bar{x}$、標準偏差をsとした時の歪度の値は以下。
(=**ということは観測データに基づく指標**！！)

$$
歪度 = \frac{n}{(n-1)(n-2)}
\sum_{i=1}^n{(\frac{x_i - \bar{x}}{s})^3}
$$

## 尖度(せんど)

分布が正規分布と比べてどれだけ尖っているかを表す。
正規分布では0。尖度が正なら平均付近が尖った分布に、尖度が負なら平べったい分布となる。

サンプルサイズをn、各データ$x_i(i=1, 2, \cdots, n)$の平均値を$\bar{x}$、標準偏差をsとした時の尖度の値は以下。

$$
尖度 = \frac{n(n+1)}{(n-1)(n-2)(n-3)}
\sum_{i=1}^n{
    \left(
        \frac{(x_i-\bar{x})^4}{s^4}
        - \frac{3(n-1)^2}{(n-2)(n-3)}
    \right)
}
$$

## 第一種の過誤

「ガンでない人をガンであると診断してしまうこと」
帰無仮説が真であるのに、帰無仮説を偽として棄却してしまう誤り。**偽陽性**。
**危険率α**と表記されることが多い。

## 第二種の過誤・検出力

「ガンである人をガンでないと診断してしまうこと」
帰無仮説が偽であるのに、帰無仮説を棄却しない誤り。**偽陰性**。
βと表記されることが多い。$1-\beta$を**検出力**と呼ぶ。

## フィッシャーの三原則

- 繰り返し(反復 repetition)
  - 1回だけの実験ではどの程度の誤差がある処理なのか分からないので、何回も実験をすること。
  - **偶然誤差の大きさを評価**することができる。
- 無作為化(ランダム化、Randomization)
  - 実験結果に影響を与えかねない要因（時刻、気温、日照etc）が、**なるべくバラバラになるよう**割り当てること。
  - **系統誤差を偶然誤差に転化**することができる。
- 局所管理（Local Control）
  - 実験結果に影響を与えかねない要因（実験場所、時間帯、担当者etc）を、実験のブロック内ではできるだけ均一になるように実験ブロックを小分けにすること。
  - **系統誤差も分散分析の要因に取り込むことができる**。

これら３つを全て取り入れた実験方法を乱塊法と呼ぶ。

## ラスパイレス指数

様々な商品の価格を調べるのは比較的簡単だが、購入数量を毎回調べるのは大変なので、過去に調査済みの購入数量を使い続けながら**物価変動を表現する**のがラスパイレス指数。

$$
ラスパイレス指数 = 100 \times \frac{\sum(基準年数量 \times 比較年価格)}{\sum(基準年数量 \times 基準年価格)}
$$

## ローレンツ曲線・ジニ係数

- **階級値ごとの累積相対度数を折れ線にしたもの**が**ローレンツ曲線**。
  - ローレンツ曲線は**ある事象の集中の度合いを示す曲線**で、所得や貯蓄の格差などを示す時に有効なグラフ。
- 完全平等線(45度線)とローレンツ曲線の間の面積の２倍が**ジニ係数**。
  - ジニ係数は必ず0から1の間の値を取る。
  - ジニ係数が0なら格差はない（全員の富が等しい）。
  - ジニ係数が1なら格差が最大（一人が全ての富を独占している）。
    ![](https://www.stat.go.jp/naruhodo/img/picture/9_4_6.png)

## 抽出法(=サンプリング方法?)

- 単純無作為抽出
  - 母集団からランダムに一つづつ標本を抽出する方法。
- 系統抽出
  - 母集団に通し番号を付け、等間隔で標本を抽出する方法。
  - 母集団がランダムに並んでいないと、偏った結果が出ることがある。
- 集団抽出(クラスター抽出)
  - 母集団から無作為にいくつかグループを選び、そのグループから全数を抽出する方法。
  - 例えばまず学校を選び、その全生徒に対して調査を行う場合。
- 多段抽出
  - 母集団から無作為にいくつかグループを選び、そのグループからさらに無作為にいくつかグループを選び...を繰り返し、最後のグループから全数を抽出する方法。
- 層別抽出(層化抽出)
  - 母集団をいくつかの層（グループ）に分け、それぞれの層から単純無作為抽出を行う方法。
  - 層内はなるべく均質になるようにする。
  - 例えば性別、年代、地域などで層を分ける。

# ベイズの定理

事象Aが起こるという条件のもとで、事象Bが起きる確率 $P(B|A)$ は...(同時確率の2種類の因数分解から導出できる)

$$
P(B|A) = \frac{P(A|B) P(B)}{P(A)}
$$

# チェビシェフの不等式(Chebyshev's inequality)

- ある確率変数において、確率分布の平均から$k \times 標準偏差\sigma$以上離れた値(の割合?の確率密度?)は、全体の$\frac{1}{k^2}$を超えることはない。(という法則？)

- 確率変数Xが平均$\mu$、分散$\sigma^2$の確率分布に従う時、任意の実数$k>0$に対して、以下の不等式が成立する。
  $$
  P(|X-\mu|\geq k\sigma) \leq \frac{1}{k^2}
  $$
- チェビシェフの不等式は、どのような確率分布の確率変数Xにおいても成り立つ。

## チェビシェフの不等式の使い方1

$E[X]=3, V[X]=1$である確率分布に従う確率変数Xについて考える。

この確率分布において、$1\geq X$もしくは$5\leq X$となる確率(たぶん密度の和)をチェビシェフの不等式を使って求めてみる。

$$
\Leftrightarrow P(1\geq X, 5 \leq X) \\
\Leftrightarrow P(1-\mu \geq X-\mu, 5 -\mu \leq X-\mu) \\
\Leftrightarrow P(-2 \geq X-3, 2 \leq X-3)
\because E[X]=3 \\
\Leftrightarrow P(|X-3| \geq 2)
$$

となる確率を求めれば良いことが分かる。ここでチェビシェフの不等式を用いると...

$$
P(|X-\mu|\geq k\sigma) \leq \frac{1}{k^2} \\
\Leftrightarrow
P(|X-3|\geq k) \leq \frac{1}{k^2} \\
$$

上記の式にk=2を当てはめて...

$$
 P(|X-3| \geq 2) = \frac{1}{4}
$$

すなわち、$1\geq X$もしくは$5\leq X$となる確率は1/4以下であると考えられる。

## チェビシェフの不等式の使い方2

$E[X]=10, V[X]=2$である確率分布に従う確率変数Xについて考える。

この確率分布において、$5 \leq X \leq 15$となる確率(たぶん密度の和)をチェビシェフの不等式を使って求めてみる。

$$
\Leftrightarrow P(5\leq X\leq 15) \\
\Leftrightarrow P(5 -\mu \leq X - \mu \leq 15-\mu) \\
\Leftrightarrow P(-5 \leq X - 10 \leq 5) \\
\Leftrightarrow P(|X - 10| \leq 5)
$$

となる確率を求めれば良い事が分かる。
チェビシェフの不等式より、(不等号の向きに注意!!)

$$
P(|X-\mu|\geq k\sigma) \leq \frac{1}{k^2} \\
\Leftrightarrow
P(|X-\mu|\leq k\sigma) \geq 1- \frac{1}{k^2}
$$

よって、対象の確率分布において以下の不等式が成立する事が分かる。

$$
P(|X - 10| \leq k \sqrt{2}) \geq 1- \frac{1}{k^2}
$$

従って、求める確率の値は...

$$
P(|X - 10| \leq 5) \\
=
P(|X - 10| \leq \frac{5}{\sqrt{2}} \sqrt{2} ) \geq 1 - \frac{1}{(\frac{5}{\sqrt{2}})^2} = \frac{23}{25}\\
$$

すなわち、$5 \leq X \leq 15$となる確率は、$\frac{23}{25}$以上であると考えられる！

## チェビシェフの不等式の証明(離散型確率変数の場合)

離散型確率分布の分散は、以下の式で計算できる。

$$
V[X] = \sigma^2 = \sum_{i=1}{(x_i - \mu)^2 f(x_i)}
$$

この式を、以下の様に展開していく。

$$
V[X] = \sigma^2 = \sum_{i=1}{(x_i - \mu)^2 f(x_i)} \\
= \sum_{i \in (|x_i-\mu|< k\sigma)}{(x_i - \mu)^2 f(x_i)}
+ \sum_{i \in (|x_i-\mu|\geq k\sigma)}{(x_i - \mu)^2 f(x_i)} \\

\Leftrightarrow
V[X] = \sigma^2 \geq \sum_{i \in (|x_i-\mu|\geq k\sigma)}{(x_i - \mu)^2 f(x_i)}
$$

ここで上式におけるΣ内の各x_iは、$|x_i-\mu|\geq k\sigma$を満たすような離散値なので、$|x_i-\mu|^2 \geq (k\sigma)^2$が成立する。よって、

$$
\sigma^2 \geq \sum_{i \in (|x_i-\mu|\geq k\sigma)}{(x_i - \mu)^2 f(x_i)} \\
\geq \sum_{i \in (|x_i-\mu|\geq k\sigma)}{(k \sigma)^2 f(x)} \\
= k^2\sigma^2 \cdot \sum_{i \in (|x_i-\mu|\geq k\sigma)}{f(x)} \\
= k^2\sigma^2 \cdot P(|x_i-\mu|\geq k\sigma)
$$

が成立する。よって両辺を$k^2\sigma^2$で割ると、

$$
\frac{1}{k^2\sigma^2} \times \sigma^2
\geq
\frac{1}{k^2\sigma^2} \cdot k^2\sigma^2 \cdot P(|x_i-\mu|\geq k\sigma) \\
\Leftrightarrow
\frac{1}{k^2} \geq P(|x_i-\mu|\geq k\sigma)
$$

以上より、離散型確率分布においてチェビシェフの不等式が示された。

## チェビシェフの不等式の証明(連続型確率変数の場合)

連続型確率分布の分散は、以下の式で計算できる。

$$
V[X] = \sigma^2 = \int_{-\infty}^{\infty}{(x_i - \bar{x})^2f(x)dx}
$$

この式を以下の様に展開していく。

$$
V[X] = \sigma^2 = \int_{-\infty}^{\infty}{(x_i - \bar{x})^2f(x)} dx
\\
= \int_{|x_i-\mu|< k\sigma}{(x_i - \bar{x})^2 f(x)dx} + \int_{|x_i-\mu|\geq k\sigma}{(x_i - \bar{x})^2 f(x)dx}
\\
\therefore V[X] = \sigma^2 \geq \int_{|x_i-\mu|\geq k\sigma}{(x_i - \bar{x})f(x)dx}
$$

ここで、上式における$\int$内の各$x_i$は、$|x_i-\mu|\geq k\sigma$を満たすような連続値なので、

$$
\int_{|x_i-\mu|\geq k\sigma}{(x_i - \bar{x})^2f(x) dx}
\geq
\int_{|x_i-\mu|\geq k\sigma}{(k\sigma)^2f(x) dx}
\int
$$

が成立する。

# 偏相関係数

- 他の変数の影響を除外した場合の相関係数。
- 確率変数X, Yにおける、Zの影響を除いた偏相関係数を$\rho_{xy, z}$とすると、以下。
  $$
  \rho_{xy, z} = \frac{
    r(X,Y) - r(X,Z) r(Y,Z)
  }{
    \sqrt{1-r(X,Z)^2} \sqrt{1-r(Y,Z)^2}
  }
  $$

# 平均の推定と検定

## 母平均の推定

標本数をn、標本平均を$\bar{x}$、不偏分散を$\sigma^2$と置く。(全て観測値から得られる統計量)

この時、母平均を$\mu$とした場合のt統計量は...

$$
t = \frac{\bar{x}-\mu}{SE}
$$

標準誤差を

$$
SE = \frac{\sigma}{\sqrt{n}}
$$

とし、自由度$v=n-1$のt分布のパーセント点を$t_{v,p}$とおくと、有意水準$\alpha$での母平均$\mu$の信頼区間は、

$$
-t_{v, \frac{\alpha}{2}} \leq t \leq t_{v, \frac{\alpha}{2}}
\\
\Leftrightarrow
-t_{v, \frac{\alpha}{2}} \leq \frac{\bar{x}-\mu}{SE} \leq t_{v, \frac{\alpha}{2}}
\\
\Leftrightarrow
\bar{x}-t_{v, \frac{\alpha}{2}} \times SE\leq \hat{\mu} \leq
\bar{x}+t_{v, \frac{\alpha}{2}} \times SE
$$

となる。

## 1群のt検定

一つの母集団から無作為抽出したサンプルの標本平均や標本標準偏差からｐ値を算出し、「**母平均は分析者が定めた比較値と異なるか**」をｐ値で判定する方法。

ex)この県の小学生全体の平均金額は28,000円であるか否か

$$
平均の差d = \bar{x} - \mu(比較値)
$$

と置くと、統計量t

$$
t = \frac{d}{SE} = \frac{d}{\frac{\sigma}{\sqrt{n}}}
$$

は自由度v=n-1のt分布に従う。

## 対応のある2群の平均の差の検定

## 対応のない2群の検定（平均の差の検定）

# 比率の検定と推定

## 母比率の推定・1群の検定

## 2群の検定(比率の差の検定)

# 適合度検定・独立性の検定

# 分散の検定と推定

## 母分散の検定・母分散の信頼区間

## 等分散の検定(分散の比の検定)

# 一限配置分散分析

総標本数を$n$、群の数を$r$、群iの標本数を$n_i$、群iの標本を$x_i (たぶん\in \mathbb{R}^{n_i}??)$、xの標本平均を$\bar{x}$とすると...

# 回帰分析の結果の見方

- Intercept(切片)
- Estimate（回帰係数の推定値）
- Std.Error（標準誤差）
  - 回帰係数の推定値の標準誤差
- t value (t値)
  - 対象の「回帰係数が0である」という帰無仮説に対する、t検定の統計量。
  - $t value = \frac{Estimate}{Std.Error}$
- Pr(>|t|)(p値)
  - 「回帰係数が0である」という帰無仮説に対するt検定のp値。
- Residual Standard Error(残差の標準誤差)
  - ?
- Degrees of Freedom(自由度)
  - $標本数-説明変数の数(切片も含む)$
- Multiple R-squared(決定係数$R^2$)
  - 回帰式の当てはまりの良さを示す値。
  - 1以下の実数をとり、1に近い程当てはまりが良い。
- Adjusted R-squared（自由度調整済み決定係数）
  - 決定係数は説明変数が増えるほど増加する為、その影響を調整為た決定係数。
- F-statistic（F値）
  - 「（切片を除く）全ての回帰係数が0である」という帰無仮説に対するF検定の統計量と自由度（DF）、p-statistic

# 参考

- https://qiita.com/moriokumura/items/ed246efe11fc5d3fc760
